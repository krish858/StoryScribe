import { PDFDocument, rgb, StandardFonts } from "pdf-lib";

// Example JSON object (use your actual JSON)
const bookData = {
  book: {
    _id: "67d4778445ead961db53a968",
    id: "QmHq0q6mLApGnyap",
    creatorId: "67d069b4f5e1fd9b36b127a2",
    prompt:
      "a story how a liitle girl dorar mets a monkey who later becomes his best friend.",
    title: "Dorar and the Mischievous Monkey",
    content: [
      {
        chapter: 1,
        title: "Chapter 1: The Unexpected Meeting",
        content:
          "\n      In the quaint village of Ashwood, nestled between two great mountains, lived a curious little girl named Dorar. She was known throughout the village for her adventurous spirit and her love for exploring the surrounding forests. One sunny afternoon, while wandering through the forest, Dorar stumbled upon a hidden path she had never seen before. The path was overgrown with vines and shrubs, and it seemed to call out to her, beckoning her to follow it.\n\n      As she made her way down the path, the trees grew taller, and the air thickened with the scent of exotic flowers. Dorar felt as though she had entered a different world, one that was full of mysteries and wonders. She walked for what felt like hours, the path twisting and turning, until she came upon a clearing.\n\n      In the center of the clearing stood an enormous tree, its trunk twisted and gnarled with age. The tree seemed to be watching her, its branches reaching out like withered fingers. Suddenly, a figure dropped from the branches above, landing with a soft thud on the forest floor.\n\n      It was a monkey, unlike any Dorar had ever seen. Its fur was a deep, rich brown, and its eyes sparkled with intelligence. The monkey regarded Dorar with a tilt of its head, as though sizing her up. Dorar, feeling a sense of wonder, reached out a hand, and to her surprise, the monkey took it.\n\n      For a long moment, they simply looked at each other, a connection forming between them. Then, in a series of chirps and gestures, the monkey began to communicate with Dorar. She found herself understanding the monkey, as though they shared a secret language.\n\n      The monkey, whose name was Kiko, told Dorar that he had been watching her from the trees. He had been waiting for someone with a kind heart and a sense of adventure. And he had chosen Dorar to share in his secrets and to join him on a journey through the forest.\n\n      As the sun began to set, casting a warm orange glow over the forest, Dorar knew that she had found a true friend in Kiko. And she knew that their adventures were only just beginning.\n\n      Over the next several days, Dorar and Kiko explored the forest together, discovering hidden streams and secret glades. They chased after butterflies and danced in the sunlight, their laughter echoing through the trees.\n\n      As the days passed, Dorar found herself growing more confident, more self-assured. She realized that she didn't have to be afraid of the unknown, not with Kiko by her side. And she knew that their friendship was something special, something that would last a lifetime.\n\n      As the chapter comes to a close, Dorar and Kiko are sitting on a branch high above the forest floor, watching the stars twinkle to life in the night sky. They are quiet, each lost in their own thoughts, but they are together, and that is all that matters.\n\n      The forest is full of secrets, and Dorar and Kiko are ready to uncover them. They will face challenges and obstacles, but they will face them together, as friends. And as they sit there, surrounded by the beauty of nature, they know that their adventures are only just beginning.\n\n      The story of Dorar and Kiko will continue in the next chapter, where they will embark on a thrilling quest through the jungle, learning valuable lessons about trust, loyalty, and the true meaning of friendship.",
      },
      {
        chapter: 2,
        title: "The Jungle Quest",
        content:
          "Chapter 2: The Jungle Quest began with a sense of excitement and anticipation. Dorar and Kiko had spent the previous day exploring the edges of the forest, getting to know each other and forming a strong bond. As they set out on their new adventure, they were determined to explore deeper into the jungle, to discover its secrets and see what wonders it held. The sun was shining, casting dappled shadows across the forest floor, and the air was filled with the sweet scent of blooming flowers. Dorar and Kiko walked hand in hand, their footsteps quiet on the soft earth. As they walked, they chatted and laughed, enjoying each other's company. They talked about their favorite foods, their families, and their dreams for the future. The forest was alive with the sounds of birds singing and leaves rustling, and Dorar and Kiko felt as though they were a part of it, as though they belonged. After a while, they came to a clearing, and in the center of it stood an enormous tree, its trunk twisted and gnarled with age. Dorar and Kiko approached it slowly, feeling a sense of awe at its size and beauty. They walked around the tree, admiring its massive roots and the way its branches seemed to stretch up to the sky. As they walked, they noticed that the tree seemed to be... different. Its trunk seemed to be glowing, and the air around it seemed to be charged with an otherworldly energy. Dorar and Kiko exchanged a curious glance, and then they reached out to touch the tree. As soon as they did, the world around them began to change. The forest grew darker, and the air grew colder. Dorar and Kiko felt a strange sensation, as though they were being pulled through time and space. They closed their eyes, holding on to each other, and waited for whatever was happening to pass. When they opened their eyes again, they found themselves in a completely different part of the forest. They were standing at the edge of a fast-moving river, and the tree was nowhere to be seen. Dorar and Kiko looked at each other, confused and a little scared. They had no idea where they were, or how they had gotten there. But they knew they had to keep moving forward. They took a deep breath, and then they began to follow the river, seeing where it would lead them. As they walked, they stumbled upon all sorts of wonders. They saw fish swimming in the river, and birds flying overhead. They saw flowers blooming, and trees growing. And they saw the most beautiful sight of all: a stunning waterfall, cascading down a rocky cliff. Dorar and Kiko gasped in amazement, their eyes fixed on the waterfall. They had never seen anything so beautiful in their lives. They approached the waterfall slowly, feeling the mist on their faces and the sound of the water in their ears. And as they stood there, they felt a sense of peace and tranquility wash over them. They knew that they had found something special, something that would stay with them for the rest of their lives. As the sun began to set, Dorar and Kiko reluctantly tore themselves away from the waterfall. They knew they had to find their way back home, before it got too dark. They followed the river, using the stars to guide them, and eventually they saw the lights of the village in the distance. They quickened their pace, excited to be going home. And as they walked, they talked about their amazing adventure, and all the wonders they had seen. They knew that they would never forget this day, and they couldn't wait to see what the next day would bring. The next morning, Dorar and Kiko set out to explore more of the jungle, eager to see what other secrets it held. They packed some food and water, and set off early, determined to make the most of their day. As they walked, they stumbled upon all sorts of creatures, from monkeys to birds to insects. They saw amazing plants, and beautiful flowers. And they saw the most incredible sight of all: a stunning rainbow, stretching across the sky. Dorar and Kiko gasped in amazement, their eyes fixed on the rainbow. They had never seen anything so beautiful in their lives. They approached the rainbow slowly, feeling the magic of the moment. And as they stood there, they felt a sense of wonder and awe wash over them. They knew that they had found something special, something that would stay with them for the rest of their lives. As the day wore on, Dorar and Kiko continued to explore the jungle, seeing all sorts of incredible sights. They climbed trees, and followed streams. They saw animals, and plants. And they saw the most amazing sight of all: a stunning sunset, stretching across the sky. Dorar and Kiko watched in awe, their eyes fixed on the sunset. They had never seen anything so beautiful in their lives. They felt a sense of peace and tranquility wash over them, and they knew that they had found something special. As the sun dipped below the horizon, Dorar and Kiko reluctantly made their way back to the village. They were tired but happy, filled with the joy and wonder of their amazing adventure. They knew that they would never forget this day, and they couldn't wait to see what the next day would bring. Over the next few days, Dorar and Kiko continued to explore the jungle, seeing all sorts of incredible sights. They discovered hidden waterfalls, and secret caves. They saw amazing animals, and beautiful plants. And they saw the most incredible sight of all: a stunning mountain range, stretching across the horizon. Dorar and Kiko gasped in amazement, their eyes fixed on the mountains. They had never seen anything so beautiful in their lives. They felt a sense of wonder and awe wash over them, and they knew that they had found something special. As they stood there, they knew that their adventure was far from over. They had seen so many incredible sights, and they knew that there was still so much more to explore. They were excited to see what the future held, and they knew that they would always have each other, no matter what. And so, they continued on their journey, eager to see what the next day would bring. They walked for hours, taking in the sights and sounds of the jungle. They saw animals, and plants. They saw amazing rocks, and beautiful flowers. And they saw the most incredible sight of all: a stunning lake, stretching across the horizon. Dorar and Kiko gasped in amazement, their eyes fixed on the lake. They had never seen anything so beautiful in their lives. They felt a sense of peace and tranquility wash over them, and they knew that they had found something special. As they stood there, they knew that their adventure was one that they would never forget. They had seen so many incredible sights, and they had experienced so many amazing things. They had learned about trust, and loyalty. And they had learned about the true meaning of friendship. As the sun began to set, Dorar and Kiko reluctantly made their way back to the village. They were tired but happy, filled with the joy and wonder of their amazing adventure. They knew that they would never forget this day, and they couldn't wait to see what the next day would bring. The days turned into weeks, and the weeks turned into months. Dorar and Kiko continued to explore the jungle, seeing all sorts of incredible sights. They discovered hidden temples, and secret gardens. They saw amazing animals, and beautiful plants. And they saw the most incredible sight of all: a stunning eclipse, stretching across the sky. Dorar and Kiko gasped in amazement, their eyes fixed on the eclipse. They had never seen anything so beautiful in their lives. They felt a sense of wonder and awe wash over them, and they knew that they had found something special. As they stood there, they knew that their adventure was one that they would never forget. They had seen so many incredible sights, and they had experienced so many amazing things. They had learned about trust, and loyalty. And they had learned about the true meaning of friendship. And as they walked back to the village, they knew that they would always have each other, no matter what. The next chapter, 'The Stormy Night', will see Dorar and Kiko face new challenges and obstacles, but their friendship will be the foundation on which they build their experiences.",
      },
      {
        chapter: 3,
        title: "Chapter 3: The Stormy Night",
        content:
          "The Stormy Night was a chapter that would test the bond between Dorar and Kiko like never before. The sky was a deep, foreboding grey, with clouds that seemed to swirl and twist in every direction. The air was electric with anticipation, and Dorar could feel the hairs on the back of her neck standing on end. She and Kiko had been exploring the jungle for hours, and now they found themselves facing a storm that seemed to be brewing out of nowhere. The wind began to pick up, rustling the leaves and sending the trees creaking and swaying in the gusts. Dorar's heart was racing with excitement and a touch of fear, but she knew that she could count on Kiko to keep her safe. The clever monkey had a knack for staying one step ahead of danger, and Dorar trusted him implicitly. As the storm raged on, they sought shelter in a nearby cave, huddling together for warmth and comfort. The sound of the thunder boomed outside, making Dorar jump, but Kiko was there to calm her down, wrapping his arms around her and holding her close. The cave was dark and musty, but it was dry and relatively warm, and Dorar was grateful to be out of the storm. She and Kiko waited out the tempest, listening to the sound of the rain pounding against the rocks outside. As the hours passed, the storm slowly began to subside, and Dorar and Kiko emerged from the cave, blinking in the bright sunlight. The jungle was fresh and clean, with a sweet, earthy scent that filled Dorar's lungs. She smiled at Kiko, feeling grateful for the adventure they had shared, and the bond that had grown stronger between them. As they made their way back to the village, Dorar couldn't help but wonder what other adventures lay ahead for her and her beloved monkey friend. The next few days passed slowly, with Dorar and Kiko spending their days exploring the jungle and their nights cuddled up by the fire, listening to the sounds of the night. But as the days turned into weeks, Dorar began to feel a sense of restlessness, a feeling that there was something more out there for her, something that she had yet to discover. She couldn't quite put her finger on it, but she knew that she and Kiko would have to keep exploring, to keep pushing the boundaries of what they knew and understood. And so, with a sense of anticipation and excitement, Dorar and Kiko set off into the unknown, ready to face whatever lay ahead, side by side. The stormy night had been a test of their friendship, but it had also been a reminder that there was always more to explore, more to discover, and more to experience. And as they walked, the jungle seemed to stretch out before them, full of mysteries and wonders waiting to be uncovered. The trees grew taller and the path grew narrower, until Dorar and Kiko found themselves pushing through a thick curtain of vines and creepers. The air grew thick with the scent of exotic flowers, and the sound of running water grew louder, until they caught sight of a beautiful waterfall, cascading down a rocky cliff. Dorar gasped in wonder, feeling as though she had stumbled into a magical kingdom, hidden away from the rest of the world. Kiko chattered and squeaked, as though he too could sense the magic of the place, and together they approached the waterfall, feeling the mist on their faces and listening to the roar of the water. It was a moment of perfect wonder, a moment that Dorar would never forget, and as they stood there, she knew that she and Kiko would always have a special bond, a bond that would carry them through the ups and downs of life, and into the unknown. The waterfall was a symbol of the beauty and wonder of the world, a reminder that there was always more to explore, more to discover, and more to experience. And as they stood there, Dorar and Kiko both knew that they would always be ready for the next adventure, the next challenge, and the next journey into the unknown. The stormy night had been a test of their friendship, but it had also been a reminder that the greatest adventures often lay just beyond the horizon, waiting to be discovered. And with that thought, Dorar and Kiko set off once again, ready to face whatever lay ahead, side by side, and ready to take on the world. They walked for hours, the sun beating down on them, until they came to a clearing, and in the center of the clearing stood an enormous tree, its branches stretching up towards the sky. Dorar and Kiko approached the tree, feeling a sense of awe and wonder, and as they reached out to touch the trunk, they felt a strange sensation, as though the tree was alive, and was communicating with them. The tree seemed to be telling them a story, a story of the jungle and its secrets, and Dorar and Kiko listened, entranced, as the tree spoke to them in a low, rumbling voice. The story was one of magic and wonder, of adventure and danger, and Dorar and Kiko listened, spellbound, as the tree told them of the secrets that lay hidden deep within the jungle. The tree spoke of ancient ruins, hidden away for centuries, and of mysterious creatures, that roamed the jungle under the cover of darkness. The tree spoke of hidden temples, and of ancient artifacts, and Dorar and Kiko listened, their minds racing with excitement and anticipation. They knew that they had to find these secrets, to uncover the mysteries of the jungle, and to explore the unknown. And so, with a sense of determination and purpose, Dorar and Kiko set off once again, ready to face whatever lay ahead, and to uncover the secrets of the jungle. The stormy night had been a test of their friendship, but it had also been a reminder that the greatest adventures often lay just beyond the horizon, waiting to be discovered. And with that thought, Dorar and Kiko disappeared into the jungle, ready to face whatever lay ahead, side by side, and ready to take on the world. As they walked, the jungle seemed to grow darker and more ominous, the trees twisting and turning in every direction. Dorar and Kiko had to push through thick curtains of vines and creepers, and the air grew thick with the scent of decay and rot. But they pressed on, undeterred, their hearts pounding with excitement and anticipation. They knew that they were getting close to their goal, and they could feel the magic of the jungle all around them. The trees seemed to be watching them, the creatures of the jungle seemed to be waiting for them, and Dorar and Kiko knew that they were on the brink of something momentous. And then, just as they were starting to think that they would never find what they were looking for, they stumbled upon an ancient ruin, hidden away for centuries. The ruin was crumbling and decaying, but Dorar and Kiko could see the magic that still lingered in the air. They approached the entrance, their hearts pounding with excitement, and as they stepped inside, they felt a strange sensation, as though they had entered a different world. The air was thick with the scent of incense, and the sound of chanting could be heard in the distance. Dorar and Kiko looked at each other, their eyes wide with wonder, and they knew that they had stumbled upon something truly remarkable. They explored the ruin, marveling at the ancient artifacts and mysterious symbols that adorned the walls. They discovered hidden temples, and secret passageways, and they knew that they had uncovered a piece of the jungle's magic. As they made their way back to the village, Dorar turned to Kiko and smiled, feeling grateful for the adventure they had shared, and for the bond that had grown stronger between them. She knew that she would never forget this journey, and she knew that she would always treasure the memories of their time together in the jungle. The stormy night had been a test of their friendship, but it had also been a reminder that the greatest adventures often lay just beyond the horizon, waiting to be discovered. And with that thought, Dorar and Kiko returned to the village, ready to face whatever lay ahead, side by side, and ready to take on the world.",
      },
      {
        chapter: 4,
        title: "Chapter 4: The Hidden Waterfall",
        content:
          "As Dorar and Kiko ventured deeper into the jungle, they stumbled upon a hidden path they had never seen before. The path was overgrown with vines and shrubs, and it seemed to lead to a secret destination. Dorar's curiosity was piqued, and she asked Kiko if he knew where the path led. Kiko shook his head, but his eyes sparkled with excitement. Together, they decided to explore the mysterious path. The air grew thick with humidity, and the sounds of the jungle grew louder. They walked for what felt like hours, the path twisting and turning through the dense foliage. Finally, they heard the sound of rushing water. The path opened up to a breathtaking sight: a hidden waterfall, cascading down a rocky cliff. The sunlight filtered through the mist, creating a rainbow that arced across the sky. Dorar gasped in wonder, and Kiko let out a whoop of excitement. They spent the day exploring the waterfall, playing in the mist, and splashing in the pool at the base of the falls. As the sun began to set, they settled down on a rocky outcropping, watching the stars twinkle to life in the night sky. As they sat there, Dorar realized that she had never felt such a deep connection with anyone before. Kiko seemed to sense her thoughts, and he reached out to gently touch her hand. In that moment, Dorar knew that their friendship was something special, something that would last a lifetime. The next morning, they decided to explore the surrounding area, to see if they could find any other secrets the jungle held. As they wandered through the forest, they stumbled upon an old, gnarled tree, its branches twisted and tangled. Kiko, being the clever monkey he was, noticed that one of the branches seemed to be pointing to something. He followed the direction of the branch, and Dorar followed close behind. They walked for a while, the tree's branch guiding them, until they came upon a small clearing. In the center of the clearing stood an enormous stone, covered in moss and lichen. The stone seemed to be glowing with an otherworldly light, and Dorar felt a shiver run down her spine. Kiko, sensing her unease, took her hand, and together they approached the stone. As they drew closer, the light grew brighter, and Dorar felt a strange energy emanating from the stone. Suddenly, the stone began to glow with an intense, pulsing light. Dorar and Kiko shielded their eyes, and when they opened them again, they found themselves standing in a completely different location. They looked around, trying to get their bearings, but everything seemed unfamiliar. The jungle seemed to have changed, the trees taller and the air thicker. They looked at each other, confusion and excitement etched on their faces. Where were they? And how did they get there? They knew they had to find their way back to the village, but for now, they were lost in the jungle, with only each other to rely on. As they stood there, trying to make sense of their surroundings, Dorar realized that this was what their friendship was all about: exploring the unknown, facing challenges together, and trusting each other with their lives. And as they set off into the unknown, Dorar knew that she and Kiko would face whatever came next, side by side, as the best of friends. Over the next few days, they navigated the treacherous jungle terrain, using their wits and their courage to overcome the obstacles in their path. They encountered raging rivers, steep cliffs, and treacherous mudslides, but through it all, they stood together, supporting and encouraging each other. And as they walked, the jungle began to reveal its secrets to them, secrets that only the most courageous and determined of adventurers could uncover. As they journeyed deeper into the heart of the jungle, they began to realize that their friendship was not just a bond between two individuals, but a bond between two kindred spirits, connected by a shared sense of wonder and adventure. And as they emerged from the jungle, back into the bright sunlight, Dorar and Kiko knew that their friendship would last a lifetime, a testament to the power of trust, loyalty, and the unbreakable bonds of friendship. As they made their way back to the village, they were greeted as heroes, their names on the lips of every villager. And though they basked in the praise and adoration of their friends and family, they knew that the true reward was the bond they shared, a bond that would stay with them forever. The villagers gathered around, eager to hear tales of their adventures, and Dorar and Kiko were happy to oblige. They told stories of their bravery, of their cunning, and of their unwavering loyalty to each other. And as they spoke, their words painted a picture of a friendship that was strong, true, and unbreakable. The villagers listened, entranced, as Dorar and Kiko recounted their journey, and the lessons they had learned along the way. They spoke of the importance of trust, of the value of loyalty, and of the unbreakable bonds of friendship. And as they finished their tale, the villagers erupted into applause, cheering and whistling for the two heroes. Dorar and Kiko smiled, basking in the praise, but they knew that the true reward was the knowledge that their friendship would endure, a shining beacon of hope and inspiration to all who knew them. As the celebration died down, and the villagers returned to their daily lives, Dorar and Kiko slipped away, back into the jungle, ready to face whatever adventures lay ahead, side by side, as the best of friends. They walked in silence, the only sound the rustling of leaves beneath their feet. The jungle seemed to stretch on forever, a vast expanse of green and brown, with secrets waiting to be uncovered. And Dorar and Kiko, hand in hand, were ready to uncover them, their hearts full of wonder, their spirits full of adventure. As they disappeared into the jungle, the villagers looked on, smiling, knowing that the two friends would always be there, a reminder of the power of friendship and the magic of the unknown. The sun dipped below the horizon, casting the jungle in a warm, golden light. Dorar and Kiko walked on, their shadows stretching out behind them, as they journeyed deeper into the heart of the jungle, ready to face whatever lay ahead, together. The trees grew taller, the air grew thicker, and the sounds of the jungle grew louder. Dorar and Kiko walked on, their hearts pounding with excitement, their spirits soaring with anticipation. They knew that the jungle held secrets, secrets that only they could uncover. And as they walked, the jungle began to reveal its secrets, secrets that would change their lives forever. The trees seemed to close in around them, the air grew hotter, and the sounds of the jungle grew louder. Dorar and Kiko walked on, their senses on high alert, as they delved deeper into the heart of the jungle. The path grew narrower, the trees grew closer, and the sounds of the jungle grew more intense. Dorar and Kiko walked on, their hearts pounding with excitement, their spirits soaring with anticipation. And then, suddenly, they heard it. A loud roar, a deafening crash, and the ground began to shake. Dorar and Kiko looked at each other, their eyes wide with fear, as the jungle seemed to come alive around them. The trees swayed, the branches creaked, and the ground trembled. Dorar and Kiko stood frozen, their hearts pounding with fear, as the jungle seemed to unleash its fury upon them. And then, as suddenly as it had begun, everything was still. The trees stopped swaying, the branches stopped creaking, and the ground stopped trembling. Dorar and Kiko looked at each other, their eyes wide with wonder, as they realized that they had survived the jungle's fury. They took a deep breath, steadied themselves, and began to walk on, deeper into the heart of the jungle. The path grew narrower, the trees grew closer, and the sounds of the jungle grew more intense. But Dorar and Kiko walked on, their hearts pounding with excitement, their spirits soaring with anticipation. They knew that the jungle held secrets, secrets that only they could uncover. And as they walked, the jungle began to reveal its secrets, secrets that would change their lives forever. The trees seemed to close in around them, the air grew hotter, and the sounds of the jungle grew louder. Dorar and Kiko walked on, their senses on high alert, as they delved deeper into the heart of the jungle. And then, suddenly, they saw it. A clearing, a beautiful clearing, filled with flowers and trees. In the center of the clearing stood an enormous stone, covered in moss and lichen. The stone seemed to be glowing with an otherworldly light, and Dorar felt a shiver run down her spine. Kiko, sensing her unease, took her hand, and together they approached the stone. As they drew closer, the light grew brighter, and Dorar felt a strange energy emanating from the stone. Suddenly, the stone began to glow with an intense, pulsing light. Dorar and Kiko shielded their eyes, and when they opened them again, they found themselves standing in a completely different location. They looked around, trying to get their bearings, but everything seemed unfamiliar. The jungle seemed to have changed, the trees taller and the air thicker. They looked at each other, confusion and excitement etched on their faces. Where were they? And how did they get there? They knew they had to find their way back to the village, but for now, they were lost in the jungle, with only each other to rely on. As they stood there, trying to make sense of their surroundings, Dorar realized that this was what their friendship was all about: exploring the unknown, facing challenges together, and trusting each other with their lives. And as they set off into the unknown, Dorar knew that she and Kiko would face whatever came next, side by side, as the best of friends.",
      },
      {
        chapter: 5,
        title: "Chapter 5: The Promise of Forever",
        content:
          "\n      As the sun rose over the village of Ashwood, Dorar and Kiko sat on a tree branch, overlooking the forest they had grown to love. Their adventures had taken them to the deepest parts of the jungle, and through it all, their bond had grown stronger. \n      In the previous chapters, they had explored the secrets of the jungle, learned valuable lessons about trust, loyalty, and the true meaning of friendship. From their initial encounter in Chapter 1: 'The Unexpected Meeting', to their thrilling escapades in Chapter 2: 'The Jungle Quest', and through the challenges they faced in Chapter 3: 'The Stormy Night', Chapter 4: 'The Hidden Waterfall', their friendship had been the foundation on which they built their experiences.\n      In this final chapter, Dorar turned to Kiko with a smile, 'I'm going to miss our adventures, but I'm glad we have each other.' Kiko chirped in agreement, and Dorar continued, 'I promise to always be there for you, no matter what.' Kiko's eyes sparkled, and he wrapped his tail around Dorar's waist, as if to say, 'I promise the same.'\n      As they sat there, the villagers began to stir, and the sound of children's laughter filled the air. Dorar and Kiko watched as the village came to life, and they knew that their friendship was a part of something much bigger than themselves.\n      The days turned into weeks, and the weeks turned into months. Dorar and Kiko continued to explore the jungle, but now they did so with a newfound appreciation for the beauty and wonder of the world around them. They had learned that true friendship was not just about having fun, but about being there for each other through thick and thin.\n      One day, as they sat on their favorite tree branch, watching the sunset, Dorar turned to Kiko and said, 'You know, I never thought I'd find a friend like you.' Kiko looked up at her, and Dorar could see the depth of their friendship in his eyes. 'I was lost, and you found me,' Dorar said, her voice filled with emotion. 'You showed me that even in the darkest of times, there is always hope.'\n      Kiko's tail wrapped tighter around Dorar's waist, and he leaned his head against her shoulder. In that moment, Dorar knew that their friendship was a promise of forever, a bond that would last a lifetime.\n      As the sun dipped below the horizon, casting a warm orange glow over the jungle, Dorar and Kiko sat in comfortable silence, watching the stars twinkle to life in the night sky. They knew that no matter what the future held, their friendship would remain a constant, a reminder of the power of love and loyalty.\n      And so, their story came full circle, a tale of two unlikely friends who found each other in the unlikeliest of places. Dorar and Kiko's adventures would live on, a testament to the magic of friendship and the promise of forever.\n      The end.",
      },
    ],
    progress: "complete",
    createdAt: "2025-03-14T18:37:56.726Z",
    __v: 0,
  },
};

const PDFGenerator = () => {
  // Function to generate the PDF from JSON
  const generatePDF = async () => {
    const pdfDoc = await PDFDocument.create();
    const page = pdfDoc.addPage([595, 842]); // A4 page size (595x842 pt)

    // Set up the font
    const font = await pdfDoc.embedFont(StandardFonts.Helvetica);

    // Add the book title to the page
    let yPosition = 800;
    page.drawText(bookData.book.title, {
      x: 50,
      y: yPosition,
      size: 24,
      font: font,
      color: rgb(0, 0, 0),
    });

    // Add the chapters
    yPosition -= 40; // Adjusting the Y position for chapters
    for (const chapter of bookData.book.content) {
      // Add chapter title
      page.drawText(`Chapter ${chapter.chapter}: ${chapter.title}`, {
        x: 50,
        y: yPosition,
        size: 18,
        font: font,
        color: rgb(0, 0, 0),
      });

      yPosition -= 30;

      // Add chapter content
      const chapterContent = chapter.content;
      const textWidth = page.getWidth() - 100; // Make sure text doesn't overflow
      let lines = breakTextIntoLines(chapterContent, font, 12, textWidth);

      // Draw each line of chapter content
      for (const line of lines) {
        page.drawText(line, {
          x: 50,
          y: yPosition,
          size: 12,
          font: font,
          color: rgb(0, 0, 0),
        });
        yPosition -= 15;
      }

      yPosition -= 20; // Space between chapters
    }

    // Serialize the PDF document to bytes
    const pdfBytes = await pdfDoc.save();

    // Create a downloadable link for the PDF
    const blob = new Blob([pdfBytes], { type: "application/pdf" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = `${bookData.book.title}.pdf`;
    link.click();
  };

  // Function to break text into lines that fit the page width
  const breakTextIntoLines = (
    text: string,
    font: any,
    fontSize: number,
    maxWidth: number
  ): string[] => {
    const words = text.split(" ");
    let lines: string[] = [];
    let currentLine = "";

    for (const word of words) {
      // Check the width of the current line with the new word added
      const lineWidth = font.widthOfTextAtSize(currentLine + word, fontSize);
      if (lineWidth < maxWidth) {
        currentLine += word + " ";
      } else {
        lines.push(currentLine.trim());
        currentLine = word + " ";
      }
    }

    // Push the last line
    if (currentLine.length > 0) {
      lines.push(currentLine.trim());
    }

    return lines;
  };

  return (
    <div style={{ padding: "20px" }}>
      <h1>{bookData.book.title}</h1>
      <button onClick={generatePDF}>Generate PDF</button>
    </div>
  );
};

export default PDFGenerator;
